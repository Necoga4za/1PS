<%- include('./include/_header_admin', {title: '좋아요 목록 관리', cssFile: 'admin'}) %>

<main class="content-area admin-area admin-layout"> 
    <nav class="admin-sidebar">
        <h2 class="sidebar-title">빠른 이동</h2>
        <ul class="sidebar-menu">
            <li><a href="/admin" class="sidebar-link <%= (path === '/admin') ? 'active' : '' %>">🏠 대시보드</a></li>
            <li><a href="/admin/users" class="sidebar-link <%= (path === '/admin/users') ? 'active' : '' %>">👥 사용자 관리</a></li>
            <li><a href="/admin/ps-posts" class="sidebar-link <%= (path === '/admin/ps-posts') ? 'active' : '' %>">📸 P.S. 게시물 관리</a></li>
            <li><a href="/admin/likes" class="sidebar-link <%= (path === '/admin/likes') ? 'active' : '' %>">❤️ 좋아요 관리</a></li>
        </ul>
    </nav>
    <div class="main-content-area">
        <h1 class="logo">좋아요 목록 관리</h1>
    
        <p class="action-bar" style="margin-bottom: 20px;">
            현재 시스템에 기록된 총 좋아요 기록을 관리합니다.
        </p>
    
        <div class="posts-list-container">
            <% if (likes && likes.length > 0) { %>
                <table>
                    <thead>
                        <tr>
                            <th>ID (앞 4자리)</th>
                            <th>좋아요 누른 사용자</th>
                            <th>대상 P.S. 게시물 ID</th>
                            <th>좋아요 일시</th>
                            <th>관리</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% likes.forEach(like => { %>
                            <tr>
                                <td><%= like._id.toString().substring(0, 4) %>...</td>
                                
                                <td><%= like.userId ? like.userId.name : '알 수 없음' %></td> 
    
                                <td>
                                    <%= like.psPostId ? like.psPostId._id.toString().substring(0, 4) + '...' : '삭제된 게시물' %>
                                    </td>
                                
                                <td><%= like.createdAt.toLocaleDateString('ko-KR') %> <%= like.createdAt.toLocaleTimeString('ko-KR') %></td>
                                
                                <td class="action-buttons">
                                    <form action="/admin/likes/<%= like._id %>?_method=DELETE" method="POST" 
                                        style="display:inline;" 
                                        onsubmit="return confirm('정말로 이 좋아요 기록을 삭제하시겠습니까?');">
                                        <button type="submit" class="button delete-button">삭제</button>
                                    </form>
                                </td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
            <% } else { %>
                <p class="no-data">등록된 좋아요 기록이 없습니다.</p>
            <% } %>
        </div>
        
    </div>
</main>

<%- include('./include/_footer') %>